Американские ученые разработали облачную платформу, которая может оценить выраженность боли у черных лабораторных мышей. Она анализирует выражение морды животного  положение ее носа, ушей, усов и степень зажмуривания глаз. Прежде с этой задачей исследователи справлялись вручную, но, как показывают результаты, созданная платформа делает это не хуже человека, но за меньшее время. Препринт опубликован на сайте bioRxiv.org.

Возможность определять, насколько сильную боль испытывает животное, полезна не только непосредственно для ухода и лечения, но и для помощи людям например, для оценки эффективности анальгетиков. Поэтому в 2010 году была разработана шкала гримасы для белых лабораторных мышей. Также существуют такие шкалы для кошек, кроликов, лошадей, свиней и овец. Шкала гримасы для белых мышей позволяет количественно оценить степень испытываемой мышью боли по положению ее носа, ушей и усов, а также по тому, насколько сильно она зажмуривает глаза.

Чтобы создать версию шкалы для мышей, исследователи сначала собирали видеозаписи высокого качества с мышами, далее разбивали их на несколько кадров, обычно это 8–10 для каждого видео, а после передавали на оценку экспертам. Например, от боли мышь может зажмуриться или прижать уши  соответственно, эксперты отмечали это так: 0 баллов  действие отсутствует (то есть животное не жмурится или не прижимает уши), 1  выражено умеренно, 2  выражено явно. Но такая работа трудоемка, а оценки экспертов субъективны  то, как один человек оценивает боль животного, может совсем не совпадать с заключением другого.

В 2018 году исследователи под руководством Марка Зилки (Mark Zylka) из Университета Северной Каролины в Чапел-Хилл научили нейросеть разделять изображения белых мышей на те, на которых животное испытывает боль, и те, на которых гримасы боли у мыши нет. Однако нейросеть не умела оценивать боль животных количественно, как это возможно при участии экспертов и с помощью шкалы гримасы мыши. Кроме того, прежде нельзя было работать с мышами C57BL/6, потому что эти мыши имеют черный окрас. Это серьезный недостаток, потому что это самые часто используемые в исследованиях мыши. О том, почему исследователи так пристрастились к этим мышам и еще много интересного об этой самой изученной линии можно прочитать в нашем блоге.

Теперь команда Марка Зилки разработала облачную платформу PainFace для облегчения анализа гримас у черных мышей, а в будущем у мышей любого цвета и других видов млекопитающих. Она умеет определять степень боли по шкале от нуля до восьми. Для идентификации и оценки изменения в выражении морды животного PainFace использует каскад из нескольких сверточных нейросетей.

Для обучения алгоритма исследователи использовали мышей C57BL/6. О разделили мышей на три группы. Одной группе провели лапаротомию  разрез брюшной стенки и удалили один-два сантиметра кишечника, другой  лапаротомию с удалением кишечника, перед которой дополнительно ввели обезболивающее. А третьей делали имитацию операции: эти мыши также погружались в наркоз, их готовили к операции, в том числе сбривали мех на месте предполагаемого надреза, но лапаротомию они не пережили. Каждую мышь до операции и после в течение 30 минут снимали на видео в высоком качестве.

Собранные видеоролики ученые загрузили в PainFace, которая из каждого видео извлекла 400-500 изображений мыши. Таким образом были собраны более 70 000 изображений мышей. Некоторые из этих изображений люди оценили по шкале гримасы. Этот набор данных частично использовался для обучения, а частично  для последующего тестирования PainFace.

После обучения PainFace успешно определила, какая часть морды мыши представлена на изображении. Точность обнаружения глаз составила 0,84. Точность обнаружения носа и ушей равнялась 0,99, а усов  0,91.

Также после обучения PainFace смогла выставить оценки по шкале гримасы. По мере обучения точность ее оценок росла и на пике составила 0,75 и выше (то есть в 75 случаях из 100 совпадала с оценками человека). При этом оценки, которые были присвоены человеком и предсказаны PainFace, значительно перекрывались  для большинства изображений они отличались на 0,5 балла.

Авторы посчитали, какое минимальное количество кадров необходимо проанализировать, чтобы не потерять в точности оценок. Оказалось, что достаточно 75 кадров из 10-минутного видео. Для сравнения, люди вручную из трех минут видео выделяют один кадр. То есть PainFace оценивала гримасу боли у грызуна не хуже, чем человек, но справилась бы с этой задачей быстрее.

После, уже под руководством Джеффри Могила (Jeffrey Mogil) из Университета Макгилла, этот эксперимент повторили, и его результаты повторили предыдущий, подтверждая, что PainFace можно использовать для оценки гримас боли у мышей C57BL/6.

Авторам предстоит продолжить проверку PainFace, прежде, чем сделать ее доступной для исследователей по всему миру. Пока они планируют дать к ней доступ для небольшого числа экспертов в области боли. Таким образом, ученые смогут еще и еще раз проверить воспроизводимость своих результатов  с одной стороны. А с другой  это позволит повысить точность работы платформы.

Принцип действия PainFace основан машинном обучении и шкале гримасы мышей. Но, как упоминалось выше, подобные шкалы существуют и для определения выраженности боли и у других домашних и лабораторных животных, например, кошек. Шкала гримасы кошек также дала жизнь приложению, которое поможет понять, испытывает ли ваша кошка боль.

